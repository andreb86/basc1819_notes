%-------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%-------------------------------------------------------------------------------
\documentclass[paper=a4, fontsize=11pt]{report} % A4 paper and 11pt font size
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs
\usepackage{fourier} % Use the Adobe Utopia font for the document - comment 
%this line to return to the LaTeX default
\usepackage[english]{babel} % English language/hyphenation
\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{graphicx}
\usepackage[acronym]{glossaries}
%\usepackage{tikz}
%\usepackage{floats}
\graphicspath{pics}
\usepackage{sectsty} % Allows customizing section commands
\usepackage{fancyhdr} % Custom headers and footers
\usepackage{marvosym}
%-------------------------------------------------------------------------------
% Setup the listings package for the code excerpts
\usepackage{listings}
\usepackage{color}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\lstset{ 
	backgroundcolor=\color{white},   % choose the background color; you must 
									 %add \usepackage{color} or 
									 %\usepackage{xcolor}; should come as last 
									 %argument
	basicstyle=\footnotesize,        % the size of the fonts that are used for 
									 %the code
	breakatwhitespace=false,         % sets if automatic breaks should only 
									 %happen at whitespace
	breaklines=true,                 % sets automatic line breaking
	captionpos=b,                    % sets the caption-position to bottom
	commentstyle=\color{mygreen},    % comment style
	deletekeywords={...},            % if you want to delete keywords from the 
									 %given language
	escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
	extendedchars=true,              % lets you use non-ASCII characters; for 
									 %8-bits encodings only, does not work with 
									 %UTF-8
	frame=single,	                 % adds a frame around the code
	keepspaces=true,                 % keeps spaces in text, useful for keeping 
									 %indentation of code (possibly needs 
									 %columns=flexible)
	keywordstyle=\color{blue},       % keyword style
	language=[x86masm]Assembler,     % the language of the code
	morekeywords={*,...},            % if you want to add more keywords to the 
									 %set
	numbers=left,                    % where to put the line-numbers; possible 
									 %values are (none, left, right)
	numbersep=5pt,                   % how far the line-numbers are from the 
									 %code
	numberstyle=\tiny\color{mygray}, % the style that is used for the 
									 %line-numbers
	rulecolor=\color{black},         % if not set, the frame-color may be 
									 %changed on line-breaks within not-black 
									 %text (e.g. comments (green here))
	showspaces=false,                % show spaces everywhere adding particular 
									 %underscores; it overrides 
									 %'showstringspaces'
	showstringspaces=false,          % underline spaces within strings only
	showtabs=false,                  % show tabs within strings adding 
									 %particular underscores
	stepnumber=2,                    % the step between two line-numbers. If 
									 %it's 1, each line will be numbered
	stringstyle=\color{mymauve},     % string literal style
	tabsize=2,	                     % sets default tabsize to 2 spaces
	title=\lstname                   % show the filename of files included with 
									 %\lstinputlisting; also try caption 
									 %instead of title
}
\lstdefinestyle{ansic}{
	belowcaptionskip=1\baselineskip,
	frame=r,
	xleftmargin=\parindent,
	language=C,
	commentstyle=\color{green}\ttfamily,
	keywordstyle=\color{blue}\ttfamily,
	basicstyle=\footnotesize\ttfamily
}
\lstdefinestyle{asm}{
	belowcaptionskip=1\baselineskip,
	frame=r,
	xleftmargin=\parindent,
	language=[x86masm]Assembler,
	basicstyle=\footnotesize\ttfamily,
	commentstyle=\itshape\color{red},
}
\lstdefinestyle{cmds}{
	belowcaptionskip=1\baselineskip,
	frame=l,
	xleftmargin=\parindent,
	language=bash,
	basicstyle=\footnotesize\ttfamily,
	commentstyle=\itshape\color{red},
}
\lstdefinestyle{py}{
	belowcaptionskip=1\baselineskip,
	frame=l,
	xleftmargin=\parindent,
	language=python,
	basicstyle=\footnotesize\ttfamily,
	commentstyle=\itshape\color{green},
}

% End of listings setup
%-------------------------------------------------------------------------------
\pagestyle{fancyplain} % Makes all pages in the document conform to 
					   %the custom headers and footers
\fancyhead{} % No page header - if you want one, create it in the same 
             %way as the footers below
\fancyfoot[L]{} % Empty left footer
\fancyfoot[C]{} % Empty center footer
\fancyfoot[R]{\thepage} % Page numbering for right footer
\renewcommand{\headrulewidth}{0pt} % Remove header underlines
\renewcommand{\footrulewidth}{0pt} % Remove footer underlines
\setlength{\headheight}{13.6pt} % Customize the height of the header
\usepackage[margin=3cm]{geometry}
\numberwithin{equation}{section} % Number equations within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{figure}{section} % Number figures within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\numberwithin{table}{section} % Number tables within sections (i.e. 1.1, 1.2, 2.1, 2.2 instead of 1, 2, 3, 4)
\setlength\parindent{0pt} % Removes all indentation from paragraphs - comment this line for an assignment with lots of text
%-------------------------------------------------------------------------------
% GLOSSARY AND ACRONYMS ENTRIES
%-------------------------------------------------------------------------------
\makeglossaries
\newglossaryentry{BA}{name={Binary Analysis},description={Analysis of binary 
		computer programs, binaries in short, and the code within them to truly 
		understand their actual behaviour as opposed to their intended 
		behaviour}}
\newglossaryentry{SA}{name={Static Analysis},description={Analysis of a binary 
without running it}}
\newglossaryentry{DA}{name={Dynamic Analysis},description={Analysis of a binary 
at runtime}}
\newacronym{OS}{OS}{Operating System}
\newacronym{API}{API}{Application Programming Interface}
\newacronym{ISA}{ISA}{Instruction Set Architecture}
\newacronym{FS}{FS}{File System}
\newacronym{IO}{I/O}{Input/Output}
\newacronym{VM}{VM}{Virtual Machine}
\newacronym{VMM}{VMM}{Virtual Machine Monitor}
\newacronym{370-XA}{370-XA}{System 370 Extended Architecture}
\newacronym{VMF}{VMF}{Virtual Machine Facility}
\newacronym{VMA}{VMA}{Virtual Machine Assist}
\newacronym{ECPS}{ECPS}{Extended Control Program Support}
\newacronym{STB}{STB}{Shadow Table Bypass}
\newacronym{IA-32}{IA-32}{Intel Architecture 32 Bit}
\newacronym{IA-64}{IA-64}{Intel Architecture 64 Bit}
\newacronym{ABI}{ABI}{Application Binary Interface}
\newacronym{ELF}{ELF}{Executable and Linkable Format}
\newacronym{PE}{PE}{Portable Executable}
\newacronym{PLT}{PLT}{Procedure Linkage Table}
\newacronym{GDT}{GDT}{Global Description Table}
\newacronym{GPR}{GPR}{Genral Purpose Register}
\newacronym{LDT}{LDT}{Local Description Table}
\newacronym{PPN}{PPN}{Physical Page Number}
\newacronym{TLS}{TLS}{Thread Level Storage}
\newacronym{PAE}{PAE}{Physical Address Extension}
\newacronym{vDSO}{vDSO}{virtual Dynamic Shared Object}
\newacronym{CoW}{CoW}{Copy on Write}
\newacronym{LTO}{LTO}{Link-Time Optimisation}
%-------------------------------------------------------------------------------
%	TITLE SECTION
%-------------------------------------------------------------------------------
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height
% create new commands and environments for code excerpts
\newcommand{\addr}[1]{{\fontfamily{pcr}\selectfont{0x00#1}}}
\newcommand{\reg}[1]{{\fontfamily{pcr}\selectfont{#1}}}
\newcommand{\cmp}[2]{{\fontfamily{pcr}\selectfont{\textbf{cmp} #1, #2}}}
\newcommand{\mov}[2]{{\fontfamily{pcr}\selectfont{\textbf{mov} #1, #2}}}
\newcommand{\movsx}[2]{{\fontfamily{pcr}\selectfont{\textbf{movsx} #1, #2}}}
\newcommand{\lea}[2]{{\fontfamily{pcr}\selectfont{\textbf{lea} \reg{#1}, [#2]}}}
\newcommand{\radare}[1]{{\fontfamily{pcr}\selectfont\textbf{#1}}}
\newcommand{\main}{{\fontfamily{pcr}\selectfont\textbf{main()}}}
\newcommand{\func}[2]{{\fontfamily{pcr}\selectfont\textbf{#1(#2)}}}
\renewcommand{\floatpagefraction}{.8}%
\title{	
\normalfont \normalsize 
\textsc{University of Genova, DIBRIS} \\ [25pt]
\horrule{0.5pt} \\[0.4cm] % Thin top horizontal rule
\huge Binary Analysis and Secure Coding \\
\horrule{2pt} \\[0.5cm] % Thick bottom horizontal rule
}
\author{Andrea Basso} % Your name
\date{\normalsize\today} % Today's date or a custom date
\begin{document}
\maketitle % Print the title
\tableofcontents
\include{ch01_intro}
\include{ch02_compilation_and_linking}
\include{ch03_binary_analysis}
\glsaddall
\printglossary[type=\acronymtype]
\end{document}
